(this["webpackJsonpchess-react"]=this["webpackJsonpchess-react"]||[]).push([[0],{26:function(e,t,r){},29:function(e,t,r){},32:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(20),o=r.n(c),i=(r(26),r(10)),s=r(4),u=r(1);var l,d,b,p,j,h,f=function(){return Object(u.jsxs)("div",{style:{display:"block"},children:[Object(u.jsx)("div",{children:Object(u.jsx)(i.c,{to:"/createGameWithBot",children:"\u0418\u0433\u0440\u0430\u0442\u044c \u0441 \u0431\u043e\u0442\u043e\u043c"})}),Object(u.jsx)("div",{children:Object(u.jsx)(i.c,{to:"/createGame",children:"\u0418\u0433\u0440\u0430\u0442\u044c \u0441 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u043e\u043c"})})]})},v=r(6),m=r(5),O=r(3),x=r.n(O),y=r(7),g=r(8);!function(e){e.A="A",e.B="B",e.C="C",e.D="D",e.E="E",e.F="F",e.G="G",e.H="H"}(l||(l={})),function(e){e.One="One",e.Two="Two",e.Three="Two",e.Four="Four",e.Five="Five",e.Six="Six",e.Seven="Seven",e.Eight="Eight"}(d||(d={})),function(e){e.FirstSide="FirstSide",e.SecondSide="SecondSide"}(b||(b={})),function(e){e.FirstPlayer="FirstPlayer",e.SecondPlayer="SecondPlayer"}(p||(p={})),function(e){e.Men="Men",e.King="King"}(j||(j={})),function(e){e.Created="Created",e.AllPlayersRegistred="AllPlayersRegistred",e.SecondPlayerReadyToPlay="SecondPlayerReadyToPlay",e.Running="Running",e.Finished="Finished"}(h||(h={}));var k=function(e){var t=Object(n.useState)("#FFFF99"),r=Object(m.a)(t,2),a=r[0],c=r[1],o=Object(n.useState)("#000000"),i=Object(m.a)(o,2),l=i[0],d=i[1],j=Object(n.useState)("#000000"),h=Object(m.a)(j,2),f=h[0],O=h[1],y=Object(n.useState)("#FFFFFF"),g=Object(m.a)(y,2),k=g[0],w=g[1],S=Object(n.useState)(b.FirstSide),C=Object(m.a)(S,2),F=C[0],G=C[1],P=Object(n.useState)(!1),E=Object(m.a)(P,2),M=E[0],T=E[1],R=e.api,B=e.skipJoinGameLink,W=Object(s.l)(),I=function(e){var t=e.currentTarget.value;G(t)},A=function(){var e=Object(v.a)(x.a.mark((function e(){var t,r,n,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),t={myCheckerColor:f,opponentCheckerColor:k,checkerCellColor:a,nonPlayableCellColor:l,myBoardSide:F},e.next=4,R.createGameEndpoint(t);case 4:r=e.sent,n=r.id,c=r.firstPlayerCode,localStorage.setItem("gameId"+n,c),localStorage.setItem("role"+n,p.FirstPlayer),W("/game/".concat(n,"/").concat(B?"skipJoinGameLink":""));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"CreateGame"}),Object(u.jsx)("br",{}),Object(u.jsxs)("div",{children:["CheckerCellColor:",Object(u.jsx)("br",{}),Object(u.jsx)("input",{type:"color",value:a,onChange:function(e){var t=e.currentTarget.value;c(t)}})]}),Object(u.jsxs)("div",{children:["NonPlayableCellColor:",Object(u.jsx)("br",{}),Object(u.jsx)("input",{type:"color",value:l,onChange:function(e){var t=e.currentTarget.value;d(t)}})]}),Object(u.jsxs)("div",{children:["MyCheckerColor:",Object(u.jsx)("br",{}),Object(u.jsx)("input",{type:"color",value:f,onChange:function(e){var t=e.currentTarget.value;O(t)}})]}),Object(u.jsxs)("div",{children:["OpponentCheckerColor:",Object(u.jsx)("br",{}),Object(u.jsx)("input",{type:"color",value:k,onChange:function(e){var t=e.currentTarget.value;w(t)}})]}),Object(u.jsxs)("div",{children:["MyBoardSide:",Object(u.jsx)("br",{}),Object(u.jsx)("input",{name:"MyBoardSide",type:"radio",value:b.FirstSide,checked:F==b.FirstSide,onChange:I}),"FirstSide",Object(u.jsx)("br",{}),Object(u.jsx)("input",{name:"MyBoardSide",type:"radio",value:b.SecondSide,checked:F==b.SecondSide,onChange:I}),"SecondSide"]}),Object(u.jsx)("button",{disabled:M,onClick:A,children:"CreateGame"})]})},w=function(){function e(){Object(g.a)(this,e)}return Object(y.a)(e,null,[{key:"GameCreateWithHuman",value:function(){var t=Object(v.a)(x.a.mark((function t(r){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.GameCreate(r,"/game/create"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"GameCreateWithBot",value:function(){var t=Object(v.a)(x.a.mark((function t(r){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.GameCreate(r,"/game/createWithBot"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"GameCreate",value:function(){var t=Object(v.a)(x.a.mark((function t(r,n){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.fetchApi(n,"POST",r,{"content-type":"application/json"},[200]));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"RegisterSecondPlayer",value:function(){var t=Object(v.a)(x.a.mark((function t(r){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.fetchApi("/game/registerSecondPlayer","POST",r,{"content-type":"application/json"},[200,400]));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"ReadyToPlay",value:function(){var t=Object(v.a)(x.a.mark((function t(r){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.fetchApi("/game/readyToPlay","POST",null,{"content-type":"application/json",playerCode:r},[200,400]));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"GameStartWithHuman",value:function(t){return e.GameStart(t,"/game/start")}},{key:"GameStartWithBot",value:function(t){return e.GameStart(t,"/game/startWithBot")}},{key:"GameStart",value:function(){var t=Object(v.a)(x.a.mark((function t(r,n){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.fetchApi(n,"POST",r,{"content-type":"application/json"},[200,400]));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"MoveWithHuman",value:function(){var t=Object(v.a)(x.a.mark((function t(r,n,a){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.Move(r,n,a,"/game/move"));case 1:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"MoveWithBot",value:function(){var t=Object(v.a)(x.a.mark((function t(r,n,a){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.Move(r,n,a,"/game/moveWithBot"));case 1:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"Move",value:function(){var t=Object(v.a)(x.a.mark((function t(r,n,a,c){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.fetchApi(c,"POST",a,{"content-type":"application/json",playerCode:r,previousBoardStateId:n},[200]));case 1:case"end":return t.stop()}}),t)})));return function(e,r,n,a){return t.apply(this,arguments)}}()},{key:"GetInfo",value:function(){var t=Object(v.a)(x.a.mark((function t(r){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.fetchApi("/game/getInfo?gameId="+r,"GET",null,{},[200,400]));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"fetchApi",value:function(){var e=Object(v.a)(x.a.mark((function e(t,r,n,a,c){var o,i,s,u;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.host+t,{body:n&&JSON.stringify(n),headers:a,method:r});case 2:if(o=e.sent,c.includes(o.status)){e.next=8;break}return e.next=6,o.text();case 6:throw i=e.sent,new Error(i);case 8:return e.next=10,o.json();case 10:return s=e.sent,u=s,e.abrupt("return",u);case 13:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,c){return e.apply(this,arguments)}}()}]),e}();w.host="https://checker-game-api.egorluckydevdomain.ru";var S=w;var C=function(){var e=Object(n.useState)(null),t=Object(m.a)(e,2),r=t[0],a=t[1],c=Object(n.useState)(!1),o=Object(m.a)(c,2),i=o[0],l=o[1],d=Object(n.useState)(!1),b=Object(m.a)(d,2),j=b[0],f=b[1],O=Object(s.n)().id,y=Object(s.l)();if(void 0===O)throw alert("wrong url"),new Error;Object(n.useEffect)((function(){var e=function(){var e=Object(v.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=r){e.next=5;break}return e.next=3,S.GetInfo(O);case 3:t=e.sent,a(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e().catch(console.log)}));var g=function(){var e=Object(v.a)(x.a.mark((function e(){var t,r,n,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.next=3,S.RegisterSecondPlayer(O);case 3:if(t=e.sent,r=t.success,n=t.message,c=t.code,l(!1),a(null),!r){e.next=16;break}if(null!=c){e.next=12;break}throw new Error("code is null but success is true after gama registration");case 12:localStorage.setItem("gameId"+O,c),localStorage.setItem("role"+O,p.SecondPlayer),e.next=17;break;case 16:throw new Error(n);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(v.a)(x.a.mark((function e(){var t,r,n,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f(!0),null!=(t=localStorage.getItem("gameId"+O))){e.next=4;break}throw new Error("readyToPlay: player code is null");case 4:return e.next=6,S.ReadyToPlay(t);case 6:if(r=e.sent,n=r.success,c=r.message,l(!1),a(null),!n){e.next=15;break}y("/game/".concat(O)),e.next=16;break;case 15:throw new Error(c);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(u.jsxs)("div",{children:[null==r&&Object(u.jsx)(u.Fragment,{children:"Getting info about game..."}),(null===r||void 0===r?void 0:r.state)===h.Created&&Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("button",{onClick:g,disabled:i,children:"Register in game"})}),(null===r||void 0===r?void 0:r.state)===h.AllPlayersRegistred&&Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("button",{onClick:k,disabled:j,children:"I'm ready to play"})}),r&&r.state!=h.Created&&r.state!=h.AllPlayersRegistred&&Object(u.jsx)(u.Fragment,{children:"Joining complete"})]})};r(29);var F=function(e){var t,r=e.cell,n=e.checkerClick,a=(null===(t=r.checker)||void 0===t?void 0:t.role)===j.King;return Object(u.jsx)("div",{className:"checker",style:{background:r.checker.color,borderWidth:a?"5px":"1px"},onClick:function(){return n(r)}})},G=function(e){var t=e.cell,r=e.selected,n=e.click,a=e.checkerClick,c=r?"dotted":"";return Object(u.jsx)("div",{className:"cell",onClick:function(){return n(t)},style:{background:t.color,borderBottom:c,borderTop:c},children:t.checker&&Object(u.jsx)(F,{cell:t,checkerClick:a})})},P=function(e){var t=e.board,r=e.awaitableMove,c=e.role,o=e.makeMove,i=Object(n.useState)(null),s=Object(m.a)(i,2),d=s[0],b=s[1],p=function(){var e=Object(v.a)(x.a.mark((function e(t){var n,a,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r==c){e.next=2;break}return e.abrupt("return");case 2:if(!d){e.next=11;break}if(d==t){e.next=11;break}if(!d.checker.possibleMoves){e.next=11;break}if(n=t.coordinate,a=n.horizontal,i=n.vertical,!(d.checker.possibleMoves.map((function(e){return e.moveVector.to})).filter((function(e){return e.horizontal==a&&e.vertical==i})).length>0)){e.next=11;break}return e.next=10,o({from:d.coordinate,to:t.coordinate});case 10:b(null);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(e){r==c&&e.checker&&e.checker.possibleMoves&&e.checker.possibleMoves.length>0&&b(e)},h=Array(),f=Array();t.cells.map((function(e){f.push(e),e.coordinate.horizontal==l.H&&(h.push(f),f=Array())})),h.reverse();var O=0;return Object(u.jsxs)("div",{children:[Object(u.jsxs)("h3",{children:["Waiting for move from ",r==c?"YOU":"opponent"]}),Object(u.jsx)("div",{className:"board",children:h.map((function(e,t){return Object(u.jsx)(a.a.Fragment,{children:e.map((function(e){return Object(u.jsx)(G,{click:p,checkerClick:j,cell:e,selected:e.coordinate===(null===d||void 0===d?void 0:d.coordinate)},O++)}))},t)}))})]})},E=r(21),M=r.n(E);var T=function(e){var t,r=e.skipJoinGameLink,a=e.api,c=Object(s.n)().id,o=Object(n.useState)(null),l=Object(m.a)(o,2),d=l[0],b=l[1],j=null===d||void 0===d?void 0:d.state,f=localStorage.getItem("gameId"+c),O=localStorage.getItem("role"+c);if(null===f)throw new Error("player code not found");if(j==h.Running&&void 0===(null===d||void 0===d?void 0:d.boardState.board))throw new Error("board is null");Object(n.useEffect)((function(){if(void 0!==c){var e=function(){var e=Object(v.a)(x.a.mark((function e(){var t,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j!=h.SecondPlayerReadyToPlay||O!=p.FirstPlayer){e.next=12;break}return e.next=3,a.startGameEndpoint(f);case 3:if((t=e.sent).success){e.next=6;break}throw new Error(t.message);case 6:if(null!=t.awaitableMove){e.next=8;break}throw new Error("awaitable move unknown");case 8:if(null!=t.boardState){e.next=10;break}throw new Error("boardState is null");case 10:return b({success:t.success,message:t.message,awaitableMove:t.awaitableMove,boardState:t.boardState,state:h.Running}),e.abrupt("return");case 12:if((null===d||void 0===d?void 0:d.awaitableMove)!==O){e.next=14;break}return e.abrupt("return");case 14:if(j!==h.Finished){e.next=16;break}return e.abrupt("return");case 16:return e.next=18,S.GetInfo(c);case 18:return r=e.sent,b(r),e.next=22,M()(300);case 22:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e().catch(console.error)}}));var y=function(){var e=Object(v.a)(x.a.mark((function e(t){var r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.moveEndpoint(f,null===d||void 0===d?void 0:d.boardState.id,t);case 3:if((r=e.sent).success){e.next=6;break}throw new Error("move result is not success");case 6:b({success:r.success,message:r.message,awaitableMove:r.awaitableMove,boardState:r.newBoardState,state:h.Running}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),g=document.location.origin+document.location.pathname+"#/joinGame/"+c;return Object(u.jsx)("div",{children:void 0===j&&Object(u.jsx)(u.Fragment,{children:"Getting info about game"})||j===h.Created&&O===p.FirstPlayer&&r&&Object(u.jsx)(u.Fragment,{children:"Wait for opponent registration"})||j===h.Created&&O===p.FirstPlayer&&!r&&Object(u.jsxs)(u.Fragment,{children:["Send this link to your opponent:",Object(u.jsx)("br",{}),g,Object(u.jsx)("br",{}),Object(u.jsx)("button",{onClick:function(){navigator.clipboard.writeText(g)},children:"Copy"}),Object(u.jsx)("br",{}),"and wait for his/her registration"]})||j===h.Created&&O===p.SecondPlayer&&Object(u.jsx)("button",{children:"Register in game"})||j===h.AllPlayersRegistred&&O===p.FirstPlayer&&Object(u.jsx)(u.Fragment,{children:"Opponent has registred, waiting for opponent will be ready to play"})||j===h.AllPlayersRegistred&&O===p.SecondPlayer&&Object(u.jsx)("button",{children:"I'm ready to play"})||j===h.SecondPlayerReadyToPlay&&O===p.FirstPlayer&&Object(u.jsx)(u.Fragment,{children:"Opponent is ready to play. Starting the game..."})||j===h.SecondPlayerReadyToPlay&&O===p.SecondPlayer&&Object(u.jsx)(u.Fragment,{children:"Waiting for start of the game by game creator"})||j===h.Running&&Object(u.jsx)(P,{board:null===d||void 0===d||null===(t=d.boardState)||void 0===t?void 0:t.board,awaitableMove:null===d||void 0===d?void 0:d.awaitableMove,role:O,makeMove:y})||j===h.Finished&&Object(u.jsxs)(u.Fragment,{children:["Game over. ",(null===d||void 0===d?void 0:d.winner)==O?"You won":"You lose"," ",Object(u.jsx)("br",{}),Object(u.jsx)(i.b,{to:"/",children:"Menu"})]})})},R={createGameEndpoint:S.GameCreateWithBot},B={createGameEndpoint:S.GameCreateWithHuman},W={startGameEndpoint:S.GameStartWithBot,moveEndpoint:S.MoveWithBot},I={startGameEndpoint:S.GameStartWithHuman,moveEndpoint:S.MoveWithHuman},A=function(){return Object(u.jsx)("div",{className:"app",children:Object(u.jsx)(i.a,{children:Object(u.jsxs)(s.c,{children:[Object(u.jsx)(s.a,{path:"/",element:Object(u.jsx)(f,{})}),Object(u.jsx)(s.a,{path:"/createGameWithBot",element:Object(u.jsx)(k,{api:R,skipJoinGameLink:!0})}),Object(u.jsx)(s.a,{path:"/createGame",element:Object(u.jsx)(k,{api:B,skipJoinGameLink:!1})}),Object(u.jsx)(s.a,{path:"/joinGame/:id",element:Object(u.jsx)(C,{})}),Object(u.jsx)(s.a,{path:"/game/:id",element:Object(u.jsx)(T,{skipJoinGameLink:!1,api:I})}),Object(u.jsx)(s.a,{path:"/game/:id/skipJoinGameLink",element:Object(u.jsx)(T,{skipJoinGameLink:!0,api:W})})]})})})};o.a.render(Object(u.jsx)(A,{}),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.64cafabf.chunk.js.map